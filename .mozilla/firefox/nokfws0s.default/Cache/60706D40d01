<!-- This HTML file has been created by texi2html 1.27
     from emacs.texi on 3 March 1994 -->

<TITLE>GNU Emacs Manual - Reading Mail with Rmail</TITLE>
<P>Go to the <A HREF="emacs_30.html">previous</A>, <A HREF="emacs_32.html">next</A> section.<P>
<A NAME="IDX1330"></A>
<A NAME="IDX1331"></A>
<A NAME="IDX1332"></A>
<H1><A NAME="SEC253" HREF="emacs_toc.html#SEC253">Reading Mail with Rmail</A></H1>
<P>
  Rmail is an Emacs subsystem for reading and disposing of mail that you
receive.  Rmail stores mail messages in files called Rmail files.
Reading the message in an Rmail file is done in a special major mode,
Rmail mode, which redefines most letters to run commands for managing
mail.  To enter Rmail, type <KBD>M-x rmail</KBD>.  This reads your primary
mail file, merges new mail in from your inboxes, displays the first
message you haven't read yet, and lets you begin reading.
<A NAME="IDX1333"></A>
<P>
  Using Rmail in the simplest fashion, you have one Rmail file <TT>`~/RMAIL'</TT>
in which all of your mail is saved.  It is called your <DFN>primary mail
file</DFN>.  In more sophisticated usage, you can copy messages into other Rmail
files and then edit those files with Rmail.
<P>
  Rmail uses narrowing to hide all but one message in the Rmail file.
The message that is shown is called the <DFN>current message</DFN>.  Rmail
mode's special commands can do such things as delete the current
message, copy into another file, send a reply, or move to another
message.
<A NAME="IDX1334"></A>
<P>
  Within the Rmail file, messages are arranged sequentially in order
of receipt.  They are also assigned consecutive integers as their
<DFN>message numbers</DFN>.  The number of the current message is displayed
in Rmail's mode line, followed by the total number of messages in the
file.  You can move to a message by specifying its message number
using the <KBD>j</KBD> key (see section <A HREF="emacs_31.html#SEC255">Moving Among Messages</A>).
<A NAME="IDX1335"></A>
<A NAME="IDX1336"></A>
<P>
  Following the usual conventions of Emacs, changes in an Rmail file become
permanent only when the file is saved.  You can do this with <KBD>s</KBD>
(<CODE>rmail-save</CODE>), which also expunges deleted messages from the file
first (see section <A HREF="emacs_31.html#SEC256">Deleting Messages</A>).  To save the file without expunging, use
<KBD>C-x C-s</KBD>.  Rmail saves the Rmail file spontaneously when moving new
mail from an inbox file (see section <A HREF="emacs_31.html#SEC257">Rmail Files and Inboxes</A>).
<A NAME="IDX1337"></A>
<A NAME="IDX1338"></A>
<A NAME="IDX1339"></A>
<A NAME="IDX1340"></A>
<P>
  You can exit Rmail with <KBD>q</KBD> (<CODE>rmail-quit</CODE>); this expunges and
saves the Rmail file and then switches to another buffer.  But there is
no need to `exit' formally.  If you switch from Rmail to editing in
other buffers, and never happen to switch back, you have exited.  (The
Rmail command <KBD>b</KBD>, <CODE>rmail-bury</CODE>, does this for you.)  Just make
sure to save the Rmail file eventually (like any other file you have
changed).  <KBD>C-x s</KBD> is a good enough way to do this
(see section <A HREF="emacs_19.html#SEC99">Saving Files</A>).
<P>
<H2><A NAME="SEC254" HREF="emacs_toc.html#SEC254">Scrolling Within a Message</A></H2>
<P>
  When Rmail displays a message that does not fit on the screen, it is
necessary to scroll through it.  This could be done with <KBD>C-v</KBD>, <KBD>M-v</KBD>
and <KBD>M-&#60;</KBD>, but in Rmail scrolling is so frequent that it deserves to be
easier to type.
<P>
<DL COMPACT>
<DT><KBD><KBD>SPC</KBD></KBD>
<DD>Scroll forward (<CODE>scroll-up</CODE>).
<DT><KBD><KBD>DEL</KBD></KBD>
<DD>Scroll backward (<CODE>scroll-down</CODE>).
<DT><KBD>.</KBD>
<DD>Scroll to start of message (<CODE>rmail-beginning-of-message</CODE>).
</DL>
<A NAME="IDX1341"></A>
<A NAME="IDX1342"></A>
<P>
  Since the most common thing to do while reading a message is to scroll
through it by screenfuls, Rmail makes <KBD>SPC</KBD> and <KBD>DEL</KBD> synonyms of
<KBD>C-v</KBD> (<CODE>scroll-up</CODE>) and <KBD>M-v</KBD> (<CODE>scroll-down</CODE>)
<A NAME="IDX1343"></A>
<A NAME="IDX1344"></A>
<P>
  The command <KBD>.</KBD> (<CODE>rmail-beginning-of-message</CODE>) scrolls back to the
beginning of the selected message.  This is not quite the same as <KBD>M-&#60;</KBD>:
for one thing, it does not set the mark; for another, it resets the buffer
boundaries to the current message if you have changed them.
<P>
<H2><A NAME="SEC255" HREF="emacs_toc.html#SEC255">Moving Among Messages</A></H2>
<P>
  The most basic thing to do with a message is to read it.  The way to
do this in Rmail is to make the message current.  The usual practice is
to move sequentially through the file, since this is the order of
receipt of messages.  When you enter Rmail, you are positioned at the
first message that you have not yet made current (that is, the first one
that has the <SAMP>`unseen'</SAMP> attribute; see section <A HREF="emacs_31.html#SEC260">Labels</A>).  Move
forward to see the other new messages; move backward to reexamine old
messages.
<P>
<DL COMPACT>
<DT><KBD>n</KBD>
<DD>Move to the next nondeleted message, skipping any intervening deleted <BR>
messages (<CODE>rmail-next-undeleted-message</CODE>).
<DT><KBD>p</KBD>
<DD>Move to the previous nondeleted message <BR>
(<CODE>rmail-previous-undeleted-message</CODE>).
<DT><KBD>M-n</KBD>
<DD>Move to the next message, including deleted messages
(<CODE>rmail-next-message</CODE>).
<DT><KBD>M-p</KBD>
<DD>Move to the previous message, including deleted messages
(<CODE>rmail-previous-message</CODE>).
<DT><KBD>j</KBD>
<DD>Move to the first message.  With argument <VAR>n</VAR>, move to
message number <VAR>n</VAR> (<CODE>rmail-show-message</CODE>).
<DT><KBD>&#62;</KBD>
<DD>Move to the last message (<CODE>rmail-last-message</CODE>).
<DT><KBD>&#60;</KBD>
<DD>Move to the first message (<CODE>rmail-first-message</CODE>).
<P>
<DT><KBD>M-s <VAR>regexp</VAR> <KBD>RET</KBD></KBD>
<DD>Move to the next message containing a match for <VAR>regexp</VAR>
(<CODE>rmail-search</CODE>).
<P>
<DT><KBD>- M-s <VAR>regexp</VAR> <KBD>RET</KBD></KBD>
<DD>Move to the previous message containing a match for <VAR>regexp</VAR>.
</DL>
<A NAME="IDX1345"></A>
<A NAME="IDX1346"></A>
<A NAME="IDX1347"></A>
<A NAME="IDX1348"></A>
<A NAME="IDX1349"></A>
<A NAME="IDX1350"></A>
<A NAME="IDX1351"></A>
<A NAME="IDX1352"></A>
<P>
  <KBD>n</KBD> and <KBD>p</KBD> are the usual way of moving among messages in
Rmail.  They move through the messages sequentially, but skip over
deleted messages, which is usually what you want to do.  Their command
definitions are named <CODE>rmail-next-undeleted-message</CODE> and
<CODE>rmail-previous-undeleted-message</CODE>.  If you do not want to skip
deleted messages--for example, if you want to move to a message to
undelete it--use the variants <KBD>M-n</KBD> and <KBD>M-p</KBD>
(<CODE>rmail-next-message</CODE> and <CODE>rmail-previous-message</CODE>).  A
numeric argument to any of these commands serves as a repeat
count.<P>
  In Rmail, you can specify a numeric argument by typing just the
digits.  You don't need to type <KBD>C-u</KBD> first.
<A NAME="IDX1353"></A>
<A NAME="IDX1354"></A>
<P>
  The <KBD>M-s</KBD> (<CODE>rmail-search</CODE>) command is Rmail's version of
search.  The usual incremental search command <KBD>C-s</KBD> works in Rmail,
but it searches only within the current message.  The purpose of
<KBD>M-s</KBD> is to search for another message.  It reads a regular
expression (see section <A HREF="emacs_17.html#SEC83">Syntax of Regular Expressions</A>) nonincrementally, then searches starting at
the beginning of the following message for a match.  The message
containing the match is selected.
<P>
  If <VAR>regexp</VAR> is empty, <KBD>M-s</KBD> reuses the regexp used the
previous time.
<P>
  To search backward in the file for another message, give <KBD>M-s</KBD> a
negative argument.  In Rmail you can do this with <KBD>- M-s</KBD>.
<P>
  It is also possible to search for a message based on labels.
See section <A HREF="emacs_31.html#SEC260">Labels</A>.
<A NAME="IDX1355"></A>
<A NAME="IDX1356"></A>
<A NAME="IDX1357"></A>
<A NAME="IDX1358"></A>
<A NAME="IDX1359"></A>
<A NAME="IDX1360"></A>
<P>
  To move to a message specified by absolute message number, use <KBD>j</KBD>
(<CODE>rmail-show-message</CODE>) with the message number as argument.  With
no argument, <KBD>j</KBD> selects the first message.  <KBD>&#62;</KBD>
(<CODE>rmail-last-message</CODE>) selects the last message.  <KBD>&#60;</KBD>
(<CODE>rmail-first-message</CODE>) selects the first message.
<P>
<H2><A NAME="SEC256" HREF="emacs_toc.html#SEC256">Deleting Messages</A></H2>
<A NAME="IDX1361"></A>
<P>
  When you no longer need to keep a message, you can <DFN>delete</DFN> it.  This
flags it as ignorable, and some Rmail commands pretend it is no longer
present; but it still has its place in the Rmail file, and still has its
message number.
<A NAME="IDX1362"></A>
<P>
  <DFN>Expunging</DFN> the Rmail file actually removes the deleted messages.
The remaining messages are renumbered consecutively.  Expunging is the only
action that changes the message number of any message, except for
undigestifying (see section <A HREF="emacs_31.html#SEC266">Digest Messages</A>).
<P>
<DL COMPACT>
<DT><KBD>d</KBD>
<DD>Delete the current message, and move to the next nondeleted message
(<CODE>rmail-delete-forward</CODE>).
<DT><KBD>C-d</KBD>
<DD>Delete the current message, and move to the previous nondeleted
message (<CODE>rmail-delete-backward</CODE>).
<DT><KBD>u</KBD>
<DD>Undelete the current message, or move back to a deleted message and
undelete it (<CODE>rmail-undelete-previous-message</CODE>).
<DT><KBD>x</KBD>
<DD>Expunge the Rmail file (<CODE>rmail-expunge</CODE>).
</DL>
<A NAME="IDX1363"></A>
<A NAME="IDX1364"></A>
<A NAME="IDX1365"></A>
<A NAME="IDX1366"></A>
<P>
  There are two Rmail commands for deleting messages.  Both delete the
current message and select another message.  <KBD>d</KBD> (<CODE>rmail-delete-forward</CODE>)
moves to the following message, skipping messages already deleted, while
<KBD>C-d</KBD> (<CODE>rmail-delete-backward</CODE>) moves to the previous nondeleted message.
If there is no nondeleted message to move to in the specified direction,
the message that was just deleted remains current.
<A NAME="IDX1367"></A>
<A NAME="IDX1368"></A>
<A NAME="IDX1369"></A>
<P>
  To make all the deleted messages finally vanish from the Rmail file,
type <KBD>x</KBD> (<CODE>rmail-expunge</CODE>).  Until you do this, you can still
<DFN>undelete</DFN> the deleted messages.
<A NAME="IDX1370"></A>
<A NAME="IDX1371"></A>
<P>
  To undelete, type
<KBD>u</KBD> (<CODE>rmail-undelete-previous-message</CODE>), which is designed to cancel the
effect of a <KBD>d</KBD> command (usually).  It undeletes the current message
if the current message is deleted.  Otherwise it moves backward to previous
messages until a deleted message is found, and undeletes that message.
<P>
  You can usually undo a <KBD>d</KBD> with a <KBD>u</KBD> because the <KBD>u</KBD>
moves back to and undeletes the message that the <KBD>d</KBD> deleted.  But
this does not work when the <KBD>d</KBD> skips a few already-deleted messages
that follow the message being deleted; then the <KBD>u</KBD> command
undeletes the last of the messages that were skipped.  There is no clean
way to avoid this problem.  However, by repeating the <KBD>u</KBD> command,
you can eventually get back to the message that you intend to
undelete.  You can also select a particular deleted message with
<KBD>M-p</KBD> command, then type <KBD>u</KBD> to undelete it.
<P>
  A deleted message has the <SAMP>`deleted'</SAMP> attribute, and as a result
<SAMP>`deleted'</SAMP> appears in the mode line when the current message is
deleted.  In fact, deleting or undeleting a message is nothing more than
adding or removing this attribute.  See section <A HREF="emacs_31.html#SEC260">Labels</A>.
<P>
<A NAME="IDX1372"></A>
<H2><A NAME="SEC257" HREF="emacs_toc.html#SEC257">Rmail Files and Inboxes</A></H2>
<P>
  Unix places incoming mail for you in a file that we call your
<DFN>inbox</DFN>.  When you start up Rmail, it copies the new messages from
your inbox into your primary mail file, an Rmail file, which also
contains other messages saved from previous Rmail sessions.  It is in
this file that you actually read the mail with Rmail.  This operation is
called <DFN>getting new mail</DFN>.  It can be repeated at any time using the
<KBD>g</KBD> key in Rmail.  The inbox file name is
<TT>`/usr/spool/mail/<VAR>username</VAR>'</TT> on some systems (typically
Berkeley-derived ones) and <TT>`/usr/mail/<VAR>username</VAR>'</TT> on other
systems.
<P>
  There are three reason for having separate Rmail files and inboxes.
<P>
<OL>
<LI>
The inbox file format varies between operating systems and according to
the other mail software in use.  Only one part of Rmail needs to know
about the alternatives, and it need only understand how to convert all
of them to Rmail's own format.
<P>
<LI>
The inbox file format usually doesn't provide a place for all the
information that Rmail records.
<P>
<LI>
It is very cumbersome to access an inbox file without danger of losing
mail, because it is necessary to interlock with mail delivery.
Moreover, different operating systems use different interlocking
techniques.  The strategy of moving mail out of the inbox once and for
all into a separate Rmail file avoids the need for interlocking in all
the rest of Rmail, since only Rmail operates on the Rmail file.
</OL>
<P>
  When getting new mail, Rmail first copies the new mail from the inbox
file to the Rmail file; then it saves the Rmail file; then it truncates
the inbox file.  This way, a system crash may cause duplication of mail
between the inbox and the Rmail file, but cannot lose mail.
<P>
  Copying mail from an inbox in the system's mailer directory actually puts
it in an intermediate file <TT>`~/.newmail'</TT>.  This is because the
interlocking is done by a C program that copies to another file.
<TT>`~/.newmail'</TT> is deleted after mail merging is successful.  If there is
a crash at the wrong time, this file continues to exist and will be
used as an inbox the next time you get new mail.
<P>
<H2><A NAME="SEC258" HREF="emacs_toc.html#SEC258">Multiple Mail Files</A></H2>
<P>
  Rmail operates by default on your <DFN>primary mail file</DFN>, which is named
<TT>`~/RMAIL'</TT> and receives your incoming mail from your system inbox file.
But you can also have other mail files and edit them with Rmail.  These
files can receive mail through their own inboxes, or you can move messages
into them with explicit Rmail commands (see section <A HREF="emacs_31.html#SEC259">Copying Messages Out to Files</A>).
<P>
<DL COMPACT>
<DT><KBD>i <VAR>file</VAR> <KBD>RET</KBD></KBD>
<DD>Read <VAR>file</VAR> into Emacs and run Rmail on it (<CODE>rmail-input</CODE>).
<P>
<DT><KBD>M-x set-rmail-inbox-list <KBD>RET</KBD> <VAR>files</VAR> <KBD>RET</KBD></KBD>
<DD>Specify inbox file names for current Rmail file to get mail from.
<P>
<DT><KBD>g</KBD>
<DD>Merge new mail from current Rmail file's inboxes
(<CODE>rmail-get-new-mail</CODE>).
<P>
<DT><KBD>C-u g <VAR>file</VAR> <KBD>RET</KBD></KBD>
<DD>Merge new mail from inbox file <VAR>file</VAR>.
</DL>
<A NAME="IDX1373"></A>
<A NAME="IDX1374"></A>
<P>
  To run Rmail on a file other than your primary mail file, you may use
the <KBD>i</KBD> (<CODE>rmail-input</CODE>) command in Rmail.  This visits the
file, puts it in Rmail mode, and then gets new mail from the file's
inboxes if any.  The file should be in Rmail format.  You can use
<KBD>M-x rmail-input</KBD> even when not in Rmail.
<P>
  The file you read with <KBD>i</KBD> should usually be a valid Rmail file.
If it is not, then Rmail tries to decompose it into a stream of messages
in various known formats.  If it succeeds, it converts the whole file to
an Rmail file.
<A NAME="IDX1375"></A>
<P>
  Each Rmail file can contain a list of inbox file names; you can specify
this list with <KBD>M-x set-rmail-inbox-list <KBD>RET</KBD> <VAR>files</VAR>
<KBD>RET</KBD></KBD>.  The argument can contain any number of file names, separated
by commas.  It can also be empty, which specifies that this file should
have no inboxes.  Once a list of inboxes is specified, the Rmail file
remembers it permanently until it is explicitly changed.<A NAME="IDX1376"></A>
<A NAME="IDX1377"></A>
<P>
  If an Rmail file has inboxes, new mail is merged in from the inboxes
when the Rmail file is brought into Rmail, and when you use the <KBD>g</KBD>
(<CODE>rmail-get-new-mail</CODE>) command.  If the Rmail file specifies no
inboxes, then no new mail is merged in at these times.  As a special
exception, if your primary mail file does not specify any inbox files,
it uses the standard system inbox.
<P>
  To merge mail from a file that is not the usual inbox, give the
<KBD>g</KBD> key a numeric argument, as in <KBD>C-u g</KBD>.  Then it reads a file
name and merges mail from that file.  The inbox file is not deleted or
changed in any way when <KBD>g</KBD> with an argument is used.  This is,
therefore, a general way of merging one file of messages into another.
<P>
<H2><A NAME="SEC259" HREF="emacs_toc.html#SEC259">Copying Messages Out to Files</A></H2>
<P>
<DL COMPACT>
<DT><KBD>o <VAR>file</VAR> <KBD>RET</KBD></KBD>
<DD>Append a copy of the current message to the file <VAR>file</VAR>, writing it
in Rmail file format by default (<CODE>rmail-output-to-rmail-file</CODE>).
<P>
<DT><KBD>C-o <VAR>file</VAR> <KBD>RET</KBD></KBD>
<DD>Append a copy of the current message to the file <VAR>file</VAR>,
writing it in Unix mail file format by default (<CODE>rmail-output</CODE>).
</DL>
<A NAME="IDX1378"></A>
<A NAME="IDX1379"></A>
<A NAME="IDX1380"></A>
<A NAME="IDX1381"></A>
<P>
  If an Rmail file has no inboxes, the only way messages get into it is
by means of explicit <KBD>o</KBD> commands.
<P>
  <KBD>o</KBD> (<CODE>rmail-output-to-rmail-file</CODE>) appends the current message
in Rmail format to the end of the specified file.  This is the best command
to use to move messages between Rmail files.  If the other Rmail file is
currently visited, the copying is done into the other file's Emacs buffer
instead.  You should eventually save it on disk.
<P>
  The <KBD>C-o</KBD> (<CODE>rmail-output</CODE>) command in Rmail appends a copy of
the current message to a specified file, in inbox file format.  This
is useful for moving messages into files to be read by other mail
processors that do not understand Rmail format.
<P>
  The <KBD>o</KBD> and <KBD>C-o</KBD> commands are actually equivalent (aside from
having separate file name defaults) when you specify an existing file;
both commands check the file's contents to determine which format to use
(Rmail or inbox).  But it does matter which command you use when you
specify a nonexistent file; <KBD>o</KBD> starts it in Rmail format, while
<KBD>C-o</KBD> starts it in inbox format.
<A NAME="IDX1382"></A>
<P>
  Copying a message with <KBD>o</KBD> or <KBD>C-o</KBD> gives the original copy of
the message the <SAMP>`filed'</SAMP> attribute, so that <SAMP>`filed'</SAMP> appears in
the mode line when such a message is current.  If you like to keep just
a single copy of every mail message, set the variable
<CODE>rmail-delete-after-output</CODE> to <CODE>t</CODE>; then the <KBD>o</KBD> and
<KBD>C-o</KBD> commands delete the original message after copying it.
(You can undelete the original afterward.)
<P>
  Copying messages in Unix format copies the header fields that are
displayed in Rmail at the time.  Thus, if you use the <KBD>t</KBD> command to
view the entire header and then copy the message, the entire header is
copied.
<A NAME="IDX1383"></A>
<P>
  The variable <CODE>rmail-output-file-alist</CODE> lets you specify
intelligent defaults for the output file, based on the contents of the
current message.  The value should be a list whose elements have this
form:
<P>
<PRE>
(<VAR>regexp</VAR> . <VAR>filename</VAR>)
</PRE>
<P>
If there's a match for <VAR>regexp</VAR> in the current message, then the
default file name for output is <VAR>filename</VAR>.  If multiple elements
match the message, the first matching element decides the default file
name.
<P>
<A NAME="IDX1384"></A>
<A NAME="IDX1385"></A>
<H2><A NAME="SEC260" HREF="emacs_toc.html#SEC260">Labels</A></H2>
<P>
  Each message can have various <DFN>labels</DFN> assigned to it as a means of
classification.  A label has a name; different names mean different labels.
Any given label is either present or absent on a particular message.  A few
label names have standard meanings and are given to messages automatically
by Rmail when appropriate; these special labels are called <DFN>attributes</DFN>.
All other labels are assigned only by users.
<P>
<DL COMPACT>
<DT><KBD>a <VAR>label</VAR> <KBD>RET</KBD></KBD>
<DD>Assign the label <VAR>label</VAR> to the current message (<CODE>rmail-add-label</CODE>).
<DT><KBD>k <VAR>label</VAR> <KBD>RET</KBD></KBD>
<DD>Remove the label <VAR>label</VAR> from the current message (<CODE>rmail-kill-label</CODE>).
<DT><KBD>C-M-n <VAR>labels</VAR> <KBD>RET</KBD></KBD>
<DD>Move to the next message that has one of the labels <VAR>labels</VAR>
(<CODE>rmail-next-labeled-message</CODE>).
<DT><KBD>C-M-p <VAR>labels</VAR> <KBD>RET</KBD></KBD>
<DD>Move to the previous message that has one of the labels <VAR>labels</VAR>
(<CODE>rmail-previous-labeled-message</CODE>).
<DT><KBD>C-M-l <VAR>labels</VAR> <KBD>RET</KBD></KBD>
<DD>Make a summary of all messages containing any of the labels <VAR>labels</VAR>
(<CODE>rmail-summary-by-labels</CODE>).
</DL>
<P>
Specifying an empty string for one these commands means to use the last
label specified for any of these commands.
<A NAME="IDX1386"></A>
<A NAME="IDX1387"></A>
<A NAME="IDX1388"></A>
<A NAME="IDX1389"></A>
<P>
  The <KBD>a</KBD> (<CODE>rmail-add-label</CODE>) and <KBD>k</KBD> (<CODE>rmail-kill-label</CODE>) commands allow
you to assign or remove any label on the current message.  If the <VAR>label</VAR>
argument is empty, it means to assign or remove the same label most
recently assigned or removed.
<P>
  Once you have given messages labels to classify them as you wish, there
are two ways to use the labels: in moving and in summaries.
<A NAME="IDX1390"></A>
<A NAME="IDX1391"></A>
<A NAME="IDX1392"></A>
<A NAME="IDX1393"></A>
<P>
  The command <KBD>C-M-n <VAR>labels</VAR> <KBD>RET</KBD></KBD>
(<CODE>rmail-next-labeled-message</CODE>) moves to the next message that has
one of the labels <VAR>labels</VAR>.  The argument <VAR>labels</VAR> specifies one
or more label names, separated by commas.  <KBD>C-M-p</KBD>
(<CODE>rmail-previous-labeled-message</CODE>) is similar, but moves backwards
to previous messages.  A preceding numeric argument to either one serves
as a repeat count.<P>
  The command <KBD>C-M-l <VAR>labels</VAR> <KBD>RET</KBD></KBD>
(<CODE>rmail-summary-by-labels</CODE>) displays a summary containing only the
messages that have at least one of a specified set of messages.  The
argument <VAR>labels</VAR> is one or more label names, separated by commas.
See section <A HREF="emacs_31.html#SEC262">Summaries</A>, for information on summaries.<P>
  If the <VAR>labels</VAR> argument to <KBD>C-M-n</KBD>, <KBD>C-M-p</KBD> or <KBD>C-M-l</KBD> is empty, it means
to use the last set of labels specified for any of these commands.
<P>
  Some labels such as <SAMP>`deleted'</SAMP> and <SAMP>`filed'</SAMP> have built-in
meanings and are assigned to or removed from messages automatically at
appropriate times; these labels are called <DFN>attributes</DFN>.  Here is a
list of Rmail attributes:
<P>
<DL COMPACT>
<DT><SAMP>`unseen'</SAMP>
<DD>Means the message has never been current.  Assigned to messages when
they come from an inbox file, and removed when a message is made
current.  When you start Rmail, it initially shows the first message
that has this attribute.
<DT><SAMP>`deleted'</SAMP>
<DD>Means the message is deleted.  Assigned by deletion commands and
removed by undeletion commands (see section <A HREF="emacs_31.html#SEC256">Deleting Messages</A>).
<DT><SAMP>`filed'</SAMP>
<DD>Means the message has been copied to some other file.  Assigned by the
file output commands (see section <A HREF="emacs_31.html#SEC258">Multiple Mail Files</A>).
<DT><SAMP>`answered'</SAMP>
<DD>Means you have mailed an answer to the message.  Assigned by the <KBD>r</KBD>
command (<CODE>rmail-reply</CODE>).  See section <A HREF="emacs_31.html#SEC261">Sending Replies</A>.
<DT><SAMP>`forwarded'</SAMP>
<DD>Means you have forwarded the message to other users.  Assigned by the
<KBD>f</KBD> command (<CODE>rmail-forward</CODE>).  See section <A HREF="emacs_31.html#SEC261">Sending Replies</A>.
<DT><SAMP>`edited'</SAMP>
<DD>Means you have edited the text of the message within Rmail.
See section <A HREF="emacs_31.html#SEC265">Editing Within a Message</A>.
<DT><SAMP>`resent'</SAMP>
<DD>Means you have resent the message to other users.  Assigned by the
command <KBD>M-x rmail-resend</KBD>.  See section <A HREF="emacs_31.html#SEC261">Sending Replies</A>.
</DL>
<P>
  All other labels are assigned or removed only by the user, and have no
standard meaning.
<P>
<H2><A NAME="SEC261" HREF="emacs_toc.html#SEC261">Sending Replies</A></H2>
<P>
  Rmail has several commands that use Mail mode to send outgoing mail.
See section <A HREF="emacs_30.html#SEC247">Sending Mail</A>, for information on using Mail mode.  What are
documented here are the special commands of Rmail for entering Mail mode.
Note that the usual keys for sending mail, <KBD>C-x m</KBD> and <KBD>C-x 4 m</KBD>,
are available in Rmail mode and work just as they usually do.<P>
<DL COMPACT>
<DT><KBD>m</KBD>
<DD>Send a message (<CODE>rmail-mail</CODE>).
<DT><KBD>c</KBD>
<DD>Continue editing already started outgoing message <BR>(<CODE>rmail-continue</CODE>).
<DT><KBD>r</KBD>
<DD>Send a reply to the current Rmail message (<CODE>rmail-reply</CODE>).
<DT><KBD>f</KBD>
<DD>Forward current message to other users (<CODE>rmail-forward</CODE>).
<DT><KBD>C-u f</KBD>
<DD>Resend the current message to other users (<CODE>rmail-resend</CODE>).
<DT><KBD>M-m</KBD>
<DD>Try sending a bounced message a second time (<CODE>rmail-retry-failure</CODE>).
</DL>
<A NAME="IDX1394"></A>
<A NAME="IDX1395"></A>
<A NAME="IDX1396"></A>
<P>
  The most common reason to send a message while in Rmail is to reply to
the message you are reading.  To do this, type <KBD>r</KBD>
(<CODE>rmail-reply</CODE>).  This displays the <SAMP>`*mail*'</SAMP> buffer in another
window, much like <KBD>C-x 4 m</KBD>, but preinitializes the <SAMP>`Subject'</SAMP>,
<SAMP>`To'</SAMP>, <SAMP>`CC'</SAMP> and <SAMP>`In-reply-to'</SAMP> header fields based on the
message you are replying to.  The <SAMP>`To'</SAMP> field is starts out as the
address of the person who sent the message you received, and the
<SAMP>`CC'</SAMP> field starts out with all the other recipients of that
message.
<A NAME="IDX1397"></A>
<P>
  You can exclude certain recipients from being placed automatically in
the <SAMP>`CC'</SAMP>, using the variable <CODE>rmail-dont-reply-to-names</CODE>.  Its
value should be a regular expression (as a string); any recipient that
the regular expression matches, is excluded from the <SAMP>`CC'</SAMP> field.
The default value matches your own name, and any name starting with
<SAMP>`info-'</SAMP>.  (Those names are excluded because there is a convention
of using them for large mailing lists to broadcast announcements.)
<P>
  To omit the <SAMP>`CC'</SAMP> field completely for a particular reply, enter
the reply command with a prefix argument: <KBD>C-u r</KBD>.
<P>
  Once the <SAMP>`*mail*'</SAMP> buffer has been initialized, editing and
sending the mail goes as usual (see section <A HREF="emacs_30.html#SEC247">Sending Mail</A>).  You can edit the
presupplied header fields if they are not right for you.  You can also
use the commands of Mail mode, including <KBD>C-c C-y</KBD> to yank in the
message that you are replying to, and <KBD>C-c C-q</KBD> to fill what was
thus yanked.  You can also switch to the Rmail buffer, select a
different message, switch back, and yank the new current message.
<P>
  Sometimes a message does not reach its destination.  Mailers usually
send the failed message back to you, enclosed in a <DFN>failure
message</DFN>.  The Rmail command <KBD>M-m</KBD> (<CODE>rmail-retry-failure</CODE>)
prepares to send the same message a second time: it sets up a
<SAMP>`*mail*'</SAMP> buffer with the same text and header fields as before.  If
you type <KBD>C-c C-c</KBD> right away, you send the message again exactly
the same as the first time.  Alternatively, you can edit the text or
headers and then send it.
<A NAME="IDX1398"></A>
<A NAME="IDX1399"></A>
<A NAME="IDX1400"></A>
<P>
  Another frequent reason to send mail in Rmail is to <DFN>forward</DFN> the
current message to other users.  <KBD>f</KBD> (<CODE>rmail-forward</CODE>) makes
this easy by preinitializing the <SAMP>`*mail*'</SAMP> buffer with the current
message as the text, and a subject designating a forwarded message.  All
you have to do is fill in the recipients and send.  When you forward a
message, recipients get a message which is "from" you, and which has
the original message in its contents.
<A NAME="IDX1401"></A>
<P>
  <DFN>Resending</DFN> is an alternative similar to forwarding; the
difference is that resending sends a message that is "from" the
original sender, just as it reached you--with a few added header fields
<SAMP>`Resent-from'</SAMP> and <SAMP>`Resent-to'</SAMP> to indicate that it came via
you.  To resend a message in Rmail, use <KBD>C-u f</KBD>.  (<KBD>f</KBD> runs
<CODE>rmail-forward</CODE>, which is programmed to invoke <CODE>rmail-resend</CODE>
if you provide a numeric argument.)
<A NAME="IDX1402"></A>
<A NAME="IDX1403"></A>
<P>
  The <KBD>m</KBD> (<CODE>rmail-mail</CODE>) command is used to start editing an
outgoing message that is not a reply.  It leaves the header fields empty.
Its only difference from <KBD>C-x 4 m</KBD> is that it makes the Rmail buffer
accessible for <KBD>C-c C-y</KBD>, just as <KBD>r</KBD> does.  Thus, <KBD>m</KBD> can be
used to reply to or forward a message; it can do anything <KBD>r</KBD> or <KBD>f</KBD>
can do.<A NAME="IDX1404"></A>
<A NAME="IDX1405"></A>
<P>
  The <KBD>c</KBD> (<CODE>rmail-continue</CODE>) command resumes editing the
<SAMP>`*mail*'</SAMP> buffer, to finish editing an outgoing message you were
already composing, or to alter a message you have sent.<A NAME="IDX1406"></A>
<P>
  If you set the variable <CODE>rmail-mail-new-frame</CODE> to a
non-<CODE>nil</CODE> value, then all the Rmail commands to start sending a
message create a new frame to edit it in.  This frame is deleted when
you send the message, or when you use the <SAMP>`Don't Send'</SAMP> item in the
<SAMP>`Mail'</SAMP> menu.
<P>
<A NAME="IDX1407"></A>
<H2><A NAME="SEC262" HREF="emacs_toc.html#SEC262">Summaries</A></H2>
<P>
  A <DFN>summary</DFN> is a buffer containing one line per message to give
you an overview of the mail in an Rmail file.  Each line shows the
message number, the sender, the labels, and the subject.  When the
summary buffer is selected, you can use almost all Rmail commands;
these apply to the message described by the current line of the
summary.  Moving point in the summary buffer selects messages as you
move to their summary lines.
<P>
  A summary buffer applies to a single Rmail file only; if you are
editing multiple Rmail files, each one has its own summary buffer (if
you have asked for one).  The summary buffer name is made by appending
<SAMP>`-summary'</SAMP> to the Rmail buffer's name.  Normally only one summary
buffer is displayed at a time.
<P>
<H3><A NAME="SEC263" HREF="emacs_toc.html#SEC263">Making Summaries</A></H3>
<P>
  Here are the commands to create a summary for the current Rmail file.
Once the Rmail file has a summary buffer, changes in the Rmail file
(such as deleting or expunging messages, and getting new mail)
automatically update the summary.
<P>
<DL COMPACT>
<DT><KBD>h</KBD>
<DD><DT><KBD>C-M-h</KBD>
<DD>Summarize all messages (<CODE>rmail-summary</CODE>).
<DT><KBD>l <VAR>labels</VAR> <KBD>RET</KBD></KBD>
<DD><DT><KBD>C-M-l <VAR>labels</VAR> <KBD>RET</KBD></KBD>
<DD>Summarize message that have one or more of the specified labels
(<CODE>rmail-summary-by-labels</CODE>).
<DT><KBD>C-M-r <VAR>rcpts</VAR> <KBD>RET</KBD></KBD>
<DD>Summarize messages that have one or more of the specified recipients
(<CODE>rmail-summary-by-recipients</CODE>).
<DT><KBD>C-M-t <VAR>topic</VAR> <KBD>RET</KBD></KBD>
<DD>Summarize messages that have a match for the specified regexp
<VAR>topic</VAR> in their subjects (<CODE>rmail-summary-by-topic</CODE>).
</DL>
<A NAME="IDX1408"></A>
<A NAME="IDX1409"></A>
<P>
  The <KBD>h</KBD> or <KBD>C-M-h</KBD> (<CODE>rmail-summary</CODE>) command fills the summary buffer
for the current Rmail file with a summary of all the messages in the file.
It then displays and selects the summary buffer in another window.
<A NAME="IDX1410"></A>
<A NAME="IDX1411"></A>
<A NAME="IDX1412"></A>
<P>
  <KBD>C-M-l <VAR>labels</VAR> <KBD>RET</KBD></KBD> (<CODE>rmail-summary-by-labels</CODE>) makes
a partial summary mentioning only the messages that have one or more of the
labels <VAR>labels</VAR>.  <VAR>labels</VAR> should contain label names separated by
commas.<A NAME="IDX1413"></A>
<A NAME="IDX1414"></A>
<P>
  <KBD>C-M-r <VAR>rcpts</VAR> <KBD>RET</KBD></KBD> (<CODE>rmail-summary-by-recipients</CODE>)
makes a partial summary mentioning only the messages that have one or more
of the recipients <VAR>rcpts</VAR>.  <VAR>rcpts</VAR> should contain mailing
addresses separated by commas.<A NAME="IDX1415"></A>
<A NAME="IDX1416"></A>
<P>
  <KBD>C-M-t <VAR>topic</VAR> <KBD>RET</KBD></KBD> (<CODE>rmail-summary-by-topic</CODE>)
makes a partial summary mentioning only the messages whose subjects have
a match for the regular expression <VAR>topic</VAR>.
<P>
  Note that there is only one summary buffer for any Rmail file; making one
kind of summary discards any previously made summary.
<P>
<H3><A NAME="SEC264" HREF="emacs_toc.html#SEC264">Editing in Summaries</A></H3>
<P>
  You can use the Rmail summary buffer to do almost anything you can do
in the Rmail buffer itself.  In fact, once you have a summary buffer,
there's no need to switch back to the Rmail buffer.
<P>
  You can select and display various messages in the Rmail buffer, from
the summary buffer, just by moving point in the summary buffer to
different lines.  It doesn't matter what Emacs command you use to move
point; whichever line point is on at the end of the command, that
message is selected in the Rmail buffer.
<P>
  Almost all Rmail commands work in the summary buffer as well as in the
Rmail buffer.  Thus, <KBD>d</KBD> in the summary buffer deletes the current
message, <KBD>u</KBD> undeletes, and <KBD>x</KBD> expunges.  <KBD>o</KBD> and <KBD>C-o</KBD>
output the current message to a file; <KBD>r</KBD> starts a reply to it.  You
can scroll the current message while remaining in the summary buffer
using <KBD>SPC</KBD> and <KBD>DEL</KBD>.
<P>
  The Rmail commands to move between messages also work in the summary
buffer, but with a twist: they move through the set of messages included
in the summary.  They also redisplay the Rmail buffer on the screen
(unlike cursor motion commands, which update the contents of the Rmail
buffer but don't display it in a window unless it already appears).
Here is a list of these commands:
<P>
<DL COMPACT>
<DT><KBD>n</KBD>
<DD>Move to next line, skipping lines saying `deleted', and select its
message.
<DT><KBD>p</KBD>
<DD>Move to previous line, skipping lines saying `deleted', and select
its message.
<DT><KBD>M-n</KBD>
<DD>Move to next line and select its message.
<DT><KBD>M-p</KBD>
<DD>Move to previous line and select its message.
<DT><KBD>&#62;</KBD>
<DD>Move to the last line, and select its message.
<DT><KBD>&#60;</KBD>
<DD>Move to the first line, and select its message.
<DT><KBD>M-s <VAR>pattern</VAR> <KBD>RET</KBD></KBD>
<DD>Search through messages for <VAR>pattern</VAR> starting with the current
message; select the message found, and move point in the summary buffer
to that message's line.
</DL>
<A NAME="IDX1417"></A>
<P>
  Deletion, undeletion, and getting new mail, and even selection of a
different message all update the summary buffer when you do them in the
Rmail buffer.  If the variable <CODE>rmail-redisplay-summary</CODE> is
non-<CODE>nil</CODE>, these actions also bring the summary buffer back onto
the screen.
<A NAME="IDX1418"></A>
<A NAME="IDX1419"></A>
<A NAME="IDX1420"></A>
<A NAME="IDX1421"></A>
<P>
  When you are finished using the summary, type <KBD>w</KBD>
(<CODE>rmail-summary-wipe</CODE>) to kill the summary buffer's window.  You
can also exit Rmail while in the summary.  <KBD>q</KBD>
(<CODE>rmail-summary-quit</CODE>) kills the summary window, then saves the
Rmail file and switches to another buffer.
<P>
<H2><A NAME="SEC265" HREF="emacs_toc.html#SEC265">Editing Within a Message</A></H2>
<P>
  Rmail mode provides a few special commands for moving within and editing
the current message.  In addition, the usual Emacs commands are available
(except for a few, such as <KBD>C-M-n</KBD> and <KBD>C-M-h</KBD>, that are redefined by Rmail for
other purposes).  However, the Rmail buffer is normally read-only, and to
alter it you must use the Rmail command <KBD>e</KBD> described below.
<P>
<DL COMPACT>
<DT><KBD>t</KBD>
<DD>Toggle display of original headers (<CODE>rmail-toggle-headers</CODE>).
<DT><KBD>e</KBD>
<DD>Edit current message (<CODE>rmail-edit-current-message</CODE>).
</DL>
<A NAME="IDX1422"></A>
<A NAME="IDX1423"></A>
<A NAME="IDX1424"></A>
<P>
  Rmail reformats the header of each message before displaying it.
Normally this involves deleting most header fields, on the grounds that
they are not interesting.  The variable <CODE>rmail-ignored-headers</CODE>
specifies a regexp that matches the header fields to discard in this
way.  The original headers are saved permanently, and to see what they
look like, use the <KBD>t</KBD> command (<CODE>rmail-toggle-headers</CODE>).  This
discards the reformatted headers of the current message and displays it
with the original headers.  Repeating <KBD>t</KBD> reformats the message
again.  Selecting the message again also reformats.
<A NAME="IDX1425"></A>
<A NAME="IDX1426"></A>
<P>
  The Rmail buffer is normally read only, and most of the characters you
would type to modify it (including most letters) are redefined as Rmail
commands.  This is usually not a problem since it is rare to want to change
the text of a message.  When you do want to do this, the way is to type
<KBD>e</KBD> (<CODE>rmail-edit-current-message</CODE>), which changes from Rmail mode into
Rmail Edit mode, another major mode which is nearly the same as Text mode.
The mode line indicates this change.
<P>
  In Rmail Edit mode, letters insert themselves as usual and the Rmail
commands are not available.  When you are finished editing the message and
are ready to go back to Rmail, type <KBD>C-c C-c</KBD>, which switches back to
Rmail mode.  Alternatively, you can return to Rmail mode but cancel all the
editing that you have done by typing <KBD>C-c C-]</KBD>.
<A NAME="IDX1427"></A>
<P>
  Entering Rmail Edit mode runs the hook <CODE>text-mode-hook</CODE>; then it
runs the hook <CODE>rmail-edit-mode-hook</CODE> (see section <A HREF="emacs_35.html#SEC337">Hooks</A>).  It adds the
attribute <SAMP>`edited'</SAMP> to the message.
<P>
<A NAME="IDX1428"></A>
<A NAME="IDX1429"></A>
<H2><A NAME="SEC266" HREF="emacs_toc.html#SEC266">Digest Messages</A></H2>
<P>
  A <DFN>digest message</DFN> is a message which exists to contain and carry
several other messages.  Digests are used on some moderated mailing
lists; all the messages that arrive for the list during a period of time
such as one day are put inside a single digest which is then sent to the
subscribers.  Transmitting the single digest uses much less computer
time than transmitting the individual messages even though the total
size is the same, because the per-message overhead in network mail
transmission is considerable.
<A NAME="IDX1430"></A>
<P>
  When you receive a digest message, the most convenient way to read it is
to <DFN>undigestify</DFN> it: to turn it back into many individual messages.
Then you can read and delete the individual messages as it suits you.
<P>
  To do this, type <KBD>M-x undigestify-rmail-message</KBD> after selecting
the digest message.  This extracts the submessages as separate Rmail
messages, and inserts them following the digest.  The digest message
itself is flagged as deleted.
<P>
<H2><A NAME="SEC267" HREF="emacs_toc.html#SEC267">Converting an Rmail File to Mailbox Format</A></H2>
<P>
  The command <KBD>M-x unrmail</KBD> converts a file in Rmail format
to ordinary system mailbox format, so that you can use it with
other mail-editing tools.  You must specify two arguments, the name
of the Rmail file and the name to use for the converted file.
<KBD>M-x unrmail</KBD> does not alter the Rmail file itself.
<P>
<A NAME="IDX1431"></A>
<H2><A NAME="SEC268" HREF="emacs_toc.html#SEC268">Reading Rot13 Messages</A></H2>
<P>
  Mailing list messages that might offend some readers are sometimes
encoded in a simple code called <DFN>rot13</DFN>---so named because it
rotates the alphabet by 13 letters.  This code is not for secrecy, as it
provides none; rather, it enables those who might be offended to avoid
ever seeing the real text of the message.
<A NAME="IDX1432"></A>
<P>
  To view a buffer using the rot13 code, use the command <KBD>M-x
rot13-other-window</KBD>.  This displays the current buffer in another window
which applies the code when displaying the text.
<P>Go to the <A HREF="emacs_30.html">previous</A>, <A HREF="emacs_32.html">next</A> section.<P>
